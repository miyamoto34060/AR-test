<!DOCTYPE html>
<html>
  <head>
    <title>Simple WebAR Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <script src="https://aframe.io/releases/1.4.2/aframe.min.js"></script>
    <script src="https://unpkg.com/ar.js@3.4.2/aframe/build/aframe-ar.min.js"></script>
  </head>
  <body style="margin: 0; overflow: hidden">
    <a-scene
      vr-mode-ui="enabled: false"
      embedded
      arjs="sourceType: webcam; gpsMinAccuracy: 100; gpsTimeInterval: 1000;"
      renderer="logarithmicDepthBuffer: true;"
    >
      <a-camera gps-camera rotation-reader></a-camera>
    </a-scene>

    <script>
      // GeoJSONファイルの読み込み
      fetch('line_to_points.geojson')
        .then(response => response.json())
        .then(data => {
          data.features.forEach((feature, index) => {
            const coords = feature.geometry.coordinates;
            const lon = coords[0];
            const lat = coords[1];

            const marker = document.createElement('a-sphere');
            marker.setAttribute('gps-entity-place', `latitude: ${lat}; longitude: ${lon}`);
            marker.setAttribute('radius', '5');
            marker.setAttribute('color', 'yellow');

            // スマホの高さから -1.5m にずらして「地面に置く」イメージ
            marker.setAttribute('position', {x: 0, y: -1.5, z: 0});

            document.querySelector('a-scene').appendChild(marker);
          });
        })
        .catch(error => {
          console.error('GeoJSON読み込みエラー:', error);
        });
    </script>
  </body>
</html>
